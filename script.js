
/*
const open = document.getElementById('open');
const modal_window = document.getElementById('modal_window');
const close = document.getElementById('close');

const timer = document.getElementById('countdown');
*/

/*--------------------------------------------------------------- */
const wordE1 = document.getElementById('guessbox');
const wrongLetterE1 = document.getElementById('usedlettersbank');
/*  THIS IS FOR RESTART BTN (WILL WORK ON THAT LETTER)
const playAgainBtn = document.getElementById('restart');
*/

const playAgainBtn = document.getElementById('play-button');
const popup = document.getElementById('popup-container');
const notification = document.getElementById('notification-container');
const finalMessage = document.getElementById('final-message');


const words = ['old malware', 'firewall misconfiguration', 'lack of awareness', 'unpatched software', 'weak passwords', 'no encryption', 'phishing', 'sql injection', 'buffer overflow', 'weak authorizing login credentials', 'no two step verification', 'repeated passwords', 'zero day vulnerabilities', 'os command injections', 'unchanged passwords'];

let selectedWord = words[Math.floor(Math.random() * words.length)];
const correctLetters = [];
const wrongLetters = []; 

// ------------------------------ TIMER FUNCTION HERE (MORE ORGANIZED)

const countdownEl=document.getElementById('countdown');  
const startingMinutes = .2; // change this back to 2 ( .2 is just for test )
let time = startingMinutes*60;

setInterval(updateCountdown, 1000);

function updateCountdown(){

    if(time > -1){
        const minutes=Math.floor(time/60);
        let seconds= time % 60;
        seconds=seconds < 10 ? '0' + seconds : seconds;
        countdownEl.innerHTML=minutes+":"+seconds;
        time--;
    }

  // When the timer reaches 0, have the modal display, calling the function in css file(modal-window.show)
  if(time == -1){
    modal_window.classList.add('show');
}
}

//Show hidden word
function displayWord(){
    wordE1.innerHTML = `
    ${selectedWord
    .split('')
    .map(
        letter =>`
        <span class="letter">
        ${correctLetters.includes(letter) ? letter : ''}
        </span>
        `
    )
    .join('')}
    `;

    const innerWord = wordE1.innerText.replace(/\n/g, '');

    if(innerWord === selectedWord){
        finalMessage.innerText = 'Congratulations! You won! ';
        popup.style.display= 'flex';
    }
}

/// Update the wrong letters
function updateWrongLetterE1(){
    //Display wrong letters
    wrongLetterE1.innerHTML = `
    ${wrongLetters.length > 0 ?  '<h4><u>Letters Used So Far</u></h4>' : ''}
    ${wrongLetters.map(letter => `<span>${letter}</span>`)}
    `;

    //Display parts
    figureParts.forEach((part,index) => {
        const errors = wrongLetters.length;

        if(index < errors) {
            part.style.display = 'block'
        }
        else{
            part.style.display = 'none';
        }
});
     //Check if lost
     if(wrongLetters.length === figureParts.length){
        finalMessage.innerText = 'Unfortunately you lost. ';
        popup.style.display = 'flex';
    }
}


//Keydown letter press
window.addEventListener('keydown', e =>{
    if(e.keyCode >= 65 && e.keyCode <=90){
        const letter = e.key;

        if(selectedWord.includes(letter)){
            if(!correctLetters.includes(letter)){
                correctLetters.push(letter);

                displayWord();
            } else{
                showNotification();
            }
        } else{
            if(!wrongLetters.includes(letter)){
                wrongLetters.push(letter);

                updateWrongLetterE1();
            } else{
                showNotification();
            }
        }
    }
});


displayWord();