





const wordE1 = document.getElementById('guessbox');
const wrongLetterE1 = document.getElementById('usedlettersbank');
const playAgain = document.getElementById('playagainbtn');    
const popup = document.getElementById('popup-container');       
const notification = document.getElementById('notification-container');  
const modal_window = document.getElementById('modal_window'); 
var Mscore = document.getElementById('Modalscore'); 
var resultElement = document.getElementById('points');



var score = 0;   
var current = '';       
var correctLetters = [];
var wrongLetters = []; 



var words = ['malware', 'penetration testing', 'firewall misconfiguration', 'lack of awareness', 'unpatched software', 'weak passwords', 'no encryption', 'phishing', 'sql injection', 'buffer overflow', 'weak authorizing login credentials', 'no two step verification', 'outdated components', 'zero day vulnerabilities', 'os command injection', 'insider threats', 'ransomware'];


// ------------------------------TIMER FUNCTION 
const countdownEl=document.getElementById('countdown');  
const startingMinutes = 2; // change this back to 2 ( .2 is just for test )
let time = startingMinutes*60;

setInterval(updateCountdown, 1000);

function updateCountdown(){
    if(time > -1){
        const minutes=Math.floor(time/60);
        let seconds= time % 60;
        seconds=seconds < 10 ? '0' + seconds : seconds;
        countdownEl.innerHTML=minutes+":"+seconds;
        time--;
    }
    // When the timer reaches 0, have the modal display, calling the function in css file(modal-window.show)
    if(time == -1){
        modal_window.classList.add('show');
        Mscore.textContent = score;   ///NEW CODE
        
    }
 }  





//Getting randWord
function getRandonWord(){
    var selectedWord = Math.floor(Math.random() * words.length);  //using rand to get the range from [0, words.length]
    return words[selectedWord];                                   // depending on the random index chosen, it will match in the words Array 
}

// Displaying word
function displayWord(){
    current = getRandonWord();                                      // chosen word will be store in a separate var
    correctLetters = Array(current.length).fill('_');               // inside the correctLetter Array, create a new array with length of current word stored. The length of that word will be filled with _
    wordE1.textContent = correctLetters.join('  ');                  // Display this information in the wordE1 container box 
}

function checkGuess(guess) {
    var guessIndices = [];

    for (var i = 0; i < current.length; i++) {
      if (current[i] === guess) {
        guessIndices.push(i);
        correctLetters[i] = guess;
      }
    }

    wordE1.textContent = correctLetters.join(' ');

    if (guessIndices.length > 0) {
      if (!correctLetters.includes('_')) {
        score = score + 100;
        resultElement.textContent = score;
        
        setTimeout(function() {             //settimeout to refresh everything and pick rand again
          resultElement.textContent = score;
          displayWord();
        }, 1000);                           // reset of 1ms
        
      }
    } else {
      if (!wrongLetters.includes(guess)) {
        wrongLetters.push(guess);
        wrongLetterE1.textContent = wrongLetters.join(' ');
      }
    }
  }


/*---------------------------------------------------------------------------------------------*/






/// Update the wrong letters
function updateWrongLetterE1(){
    //Display wrong letters
    wrongLetterE1.innerHTML = `
    ${wrongLetters.length > 0 ?  '<h4><u>Letters Used So Far</u></h4>' : ''}
    ${wrongLetters.map(letter => `<span>${letter}</span>`)}
    `;
}






//Allowing user to use keyboard for the game
document.addEventListener('keydown', function(event) {
    var guess = event.key.toLowerCase();
    checkGuess(guess);
  });







//Restart game
playAgain.addEventListener('click', () => {
 //Empty arrays
correctLetters.splice(0);
wrongLetters.splice(0);
selectedWord = words[Math.floor(Math.random() * words.length)];   
displayWord();    
updateWrongLetterE1();  
modal_window.style.display='none';
//reset the timer 
time = startingMinutes*60;
updateCountdown(); 
});



displayWord();